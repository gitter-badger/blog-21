# 使用JMH实现性能测试

## 前言

如果我们开发一个很实用的功能，会期望能让更多人用，以发挥他的价值。但是事实上，能不能被使用者接受，最终却是因为一些功能之外的原因决定，比如稳定性，可用性，性能等。所以为了能被大家所接受，我们所开发 的功能，需要在这些非功能方面做到足够好。

要做到足够好，需要知道它目前表现得好不好。只有知道它能表现得什么样，才能知道它好不好，才能知道怎样才能做好，才能做到足够好。需要知道表现得什么样，我们需要一套测试的方法。只有测出来的数据才有说服力。这里我们只聊性能的测试。

## 性能测试

性能指执行任务的能力，一般可以用如下两个指标来表示。

* 吞吐量（throughput）表示任务处理进度的速度
* 响应时间（response time）表示单个任务处理的速度

所以性能测试一般就是要得出这两个参数的信息。一般的性能测试方法就是启多个进程和线程同时循环执行，测量不同压力下的这两个方面的值。所以一个性能测试的工作包括：

* 编写压测逻辑：调用被测方法执行任务
* 编写起压逻辑：起进程和线程执行压测方法
* 编写控制逻辑：何时开始运行，何时开始采集数据，何时停止
* 编写数据收集逻辑：收集压测过程中`吞吐量`和`响应时间`这些信息
* 编写报告生成逻辑：生成一个结论性的报表

这些工作中，除了`编写压测逻辑`对于每个压测任务不同，其余的工作几乎都是相同的，可以复用。`JMH`就是实现了这样一些通用的逻辑，让使用者不再为这些东西花费心思，可以非常简单地编写压测程序，将心思都放在压测逻辑的编写、压测结果的分析和被测功能的优化上。

## 使用JMH编写简单的基准测试程序



## 基准测试比较
## 如何复用

